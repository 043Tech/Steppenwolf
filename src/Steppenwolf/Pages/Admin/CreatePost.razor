@page "/admin/post/create"
@* ReSharper disable RedundantUsingDirective *@
@using Steppenwolf.Pages.Post
@* ReSharper restore RedundantUsingDirective *@
@inherits CreatePostBase

<AuthorizeView>
    <Authorized Context="auth">
        <EditForm Model="@this.BlogPostCreateModel" OnValidSubmit="this.Create">
            <DataAnnotationsValidator/>
            
            @if (this.Preview)
            {
                <PostView BlogPost="@this.GetBlogPostPreviewModel()" />
            }
            else
            {
                <div class="form-group">
                    <label for="title">Title: </label>
                    <InputText Id="title" Class="form-control" @bind-Value="@BlogPostCreateModel.Title"/>
                    <ValidationMessage For="@(() => BlogPostCreateModel.Title)"/>
                </div>

                <div class="form-group">
                    <label for="body">Text: </label>
                    <InputTextArea Id="body" Class="form-control" @bind-Value="@BlogPostCreateModel.Body" rows="10"/>
                    <ValidationMessage For="@(() => BlogPostCreateModel.Body)"/>
                </div>
            }
            
            <button type="submit" class="btn btn-primary">Submit</button>
            <div class="btn btn-secondary" @onclick="() => this.Preview = !this.Preview">
                @if (this.Preview)
                {
                    <span>Edit</span>
                }
                else
                {
                    <span>Preview</span>
                }
            </div>
        </EditForm>
    </Authorized>
    <NotAuthorized>
        <RedirectTo Uri="/"/>
    </NotAuthorized>
</AuthorizeView>